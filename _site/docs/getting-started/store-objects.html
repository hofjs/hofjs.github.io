<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Store objects - Hof.js Docs</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Store objects | Hof.js Docs</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Store objects" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." /> <meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." /> <link rel="canonical" href="https://hofjs.github.io/docs/getting-started/store-objects.html" /> <meta property="og:url" content="https://hofjs.github.io/docs/getting-started/store-objects.html" /> <meta property="og:site_name" content="Hof.js Docs" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Store objects" /> <script type="application/ld+json"> {"headline":"Store objects","url":"https://hofjs.github.io/docs/getting-started/store-objects.html","@type":"WebPage","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://hofjs.github.io/" class="site-title lh-tight"> Hof.js Docs </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://hofjs.github.io/" class="nav-list-link">Overview</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://hofjs.github.io/docs/installation/" class="nav-list-link">Installation</a><ul class="nav-list "><li class="nav-list-item "><a href="https://hofjs.github.io/docs/installation/esm.html" class="nav-list-link">ESM build</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/installation/cjs.html" class="nav-list-link">CJS build</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/installation/nomodule.html" class="nav-list-link">No module build</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/installation/visual-studio-code.html" class="nav-list-link">Visual Studio Code</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://hofjs.github.io/docs/getting-started/" class="nav-list-link">Getting started</a><ul class="nav-list "><li class="nav-list-item "><a href="https://hofjs.github.io/docs/getting-started/hello-world.html" class="nav-list-link">Hello world</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/getting-started/stateful-components.html" class="nav-list-link">Stateful components</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/getting-started/derived-properties.html" class="nav-list-link">Derived properties</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/getting-started/nested-components.html" class="nav-list-link">Nested components</a></li><li class="nav-list-item active"><a href="https://hofjs.github.io/docs/getting-started/store-objects.html" class="nav-list-link active">Store objects</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/getting-started/state-hooks.html" class="nav-list-link">State hooks</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/getting-started/component-lifecycle.html" class="nav-list-link">Component lifecycle</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/getting-started/list-rendering.html" class="nav-list-link">List rendering</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/getting-started/render-functions.html" class="nav-list-link">Render functions</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/getting-started/component-styles.html" class="nav-list-link">Component styles</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://hofjs.github.io/docs/routing/" class="nav-list-link">Routing</a><ul class="nav-list "><li class="nav-list-item "><a href="https://hofjs.github.io/docs/routing/regular-routes.html" class="nav-list-link">Regular routes</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/routing/hashtag-routes.html" class="nav-list-link">Hashtag routes</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://hofjs.github.io/docs/modern-development/" class="nav-list-link">Modern development</a><ul class="nav-list "><li class="nav-list-item "><a href="https://hofjs.github.io/docs/modern-development/modern-app-sample.html" class="nav-list-link">Modern app sample</a></li><li class="nav-list-item "><a href="https://hofjs.github.io/docs/modern-development/interactive-app-tests.html" class="nav-list-link">Interactive app tests</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Hof.js Docs" aria-label="Search Hof.js Docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="/about" class="site-button" > About </a> </li> <li class="aux-nav-list-item"> <a href="https://www.hof-university.de/impressum.html" class="site-button" > Imprint / Impressum </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://hofjs.github.io/docs/getting-started/">Getting started</a></li> <li class="breadcrumb-nav-list-item"><span>Store objects</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="store-objects"> <a href="#store-objects" class="anchor-heading" aria-labelledby="store-objects"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Store objects </h1> <p><strong>Usually one wants unidirectional data flow</strong>, i.e. parent components pass state to child components and these return changes in the form of events to the parent. The reason for this is,</p> <ul> <li>parent components can represent a kind of <strong>single source of truth</strong> and the <strong>data flow</strong> can thus be <strong>structured and easily traced top-down</strong> and</li> <li>that <strong>code</strong> can be implemented <strong>more robust and less error-prone</strong> than with approaches involving e.g. two-way data binding, since mutual dependencies and cycles of updates can be avoided.</li> </ul> <p><strong>However, sometimes you need shared state between various components that are placed on different levels of a deep hierarchy of nested components</strong>. This is illustrated in the following figure.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Root component
- child component 1
  - grandchild component 1.1
    - great grandchild component 1.1.1
    - great grandchild component 1.1.2
    - ...
  - ...
- ...
- child component N
  - ...
  - grandchild component N.M
    - great grandchild component N.M.1
      - great great grandchild component N.M.1.1
</code></pre></div></div> <p><strong>If component 1.1.2 and component N.M.1.1 need access to the same data, it would be necessary to pass the object from the root through umpteen components on the path in between</strong>:</p> <ul> <li>All components on the path between the root component and the component requiring the data would have to be equipped with additional properties to pass a value downward.</li> <li>The same applies to callbacks that the child should invoke to pass new values up to the root.</li> </ul> <blockquote> <p><strong>Summing up</strong></p> <ul> <li>Additional properties required and the chain of pass down expressions would significantly complicate the code and make maintenance more difficult.</li> <li>Consequently, this approach is not suitable for sharing data between components at widely separated levels of a deep hierarchy of nested components.</li> </ul> </blockquote> <h2 id="store-objects-coming-to-the-resuce"> <a href="#store-objects-coming-to-the-resuce" class="anchor-heading" aria-labelledby="store-objects-coming-to-the-resuce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Store objects coming to the resuce </h2> <p><strong>Some frameworks offer a concept called stores to solve the problem depicted above</strong>. Usually, this means using an additional library that makes objects accessible in different components via an non standard mechanism or by using some kind of dependency injection. Often, this does not fit well with the respective framework and developers need to learn an additional paradigm.</p> <p><strong>Hof.js does not include a separate store concept, because its deep observability functionality makes concepts like that obsolete.</strong> Simple objects can be used to externalize and share state. In the following, we will take a closer look at this using an example. First, lets create a shared object:</p> <h2 id="counter-storejs"> <a href="#counter-storejs" class="anchor-heading" aria-labelledby="counter-storejs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> counter-store.js </h2> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">counterStore</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>

    <span class="kd">get</span> <span class="nx">doubled</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">count</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span> <span class="p">},</span>

    <span class="nx">increment</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">count</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>As you can see, we simply pulled all the state properties and methods that can change the state out of our component <code class="language-plaintext highlighter-rouge">simple-counter</code> and externalized them into an object called ´counterStore´. This includes our derived property <code class="language-plaintext highlighter-rouge">doubled</code>.</p> <blockquote> <p><strong>Important</strong></p> <ul> <li><strong>Don’t use an array as store object</strong> (e.g. <code class="language-plaintext highlighter-rouge">storeArray = []</code>) because this does not get observed in all situations.</li> <li>Instead, <strong>always define an object and include your array</strong>, e.g. <code class="language-plaintext highlighter-rouge">storeObject = { someArray: [] }</code>.</li> </ul> </blockquote> <p>Now lets take a look at our updated <code class="language-plaintext highlighter-rouge">simple-counter</code> component.</p> <h2 id="simple-counter-with-storejs"> <a href="#simple-counter-with-storejs" class="anchor-heading" aria-labelledby="simple-counter-with-storejs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> simple-counter-with-store.js </h2> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">customElements</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="dl">"</span><span class="s2">simple-counter</span><span class="dl">"</span><span class="p">,</span> <span class="kd">class</span> <span class="kd">extends</span> <span class="nx">HofHtmlElement</span> <span class="p">{</span>
    <span class="nx">sharedCounter</span> <span class="o">=</span> <span class="nx">counterStore</span><span class="p">;</span>

    <span class="nx">templates</span> <span class="o">=</span> <span class="nx">html</span><span class="s2">`
        &lt;div&gt;Count: </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">sharedCounter</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="s2">&lt;/div&gt;
        &lt;div&gt;Inverse count: </span><span class="p">${</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">sharedCounter</span><span class="p">.</span><span class="nx">count</span><span class="p">}</span><span class="s2">&lt;/div&gt;
        &lt;div&gt;Doubled count: </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">sharedCounter</span><span class="p">.</span><span class="nx">doubled</span><span class="p">}</span><span class="s2">&lt;/div&gt;
        &lt;button onclick="</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">sharedCounter</span><span class="p">.</span><span class="nx">increment</span><span class="p">}</span><span class="s2">"&gt;++&lt;/button&gt;
        &lt;button onclick="</span><span class="p">${()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">sharedCounter</span><span class="p">.</span><span class="nx">count</span><span class="o">--</span><span class="p">}</span><span class="s2">"&gt;--&lt;/button&gt;
      `</span>
<span class="p">})</span>
</code></pre></div></div> <p><strong>It’s really that simple</strong>:</p> <ul> <li>We added a property <code class="language-plaintext highlighter-rouge">sharedCounter</code> that references our externalized object.</li> <li>Additionally, we changed all references in the template to include <code class="language-plaintext highlighter-rouge">sharedCounter</code> as parent object.</li> </ul> <p>If you use this component in a simple webpage and test the app, <strong>everything works as expected - even externalized derived properties</strong>. And the most important part: <strong>If multiple instances of this component</strong> (or other components that use the same store object) are <strong>used, they share the same state</strong>. This means if you click a increment or decrement button of one component all changes are reflected on the other one.</p> <p>Below you can see a simple web page that contains two counter components. When the value of one of the counters is changed, the new value is immediately reflected in the other one.</p> <h2 id="simple-counter-with-storehtml"> <a href="#simple-counter-with-storehtml" class="anchor-heading" aria-labelledby="simple-counter-with-storehtml"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> simple-counter-with-store.html </h2> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Simple counter with store app<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"../../lib/nomodule/hof.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"counter-store.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"simple-counter-with-store.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Simple counter with store app<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;simple-counter&gt;&lt;/simple-counter&gt;</span>
    <span class="nt">&lt;simple-counter&gt;&lt;/simple-counter&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div> <h2 id="rendered-webpage"> <a href="#rendered-webpage" class="anchor-heading" aria-labelledby="rendered-webpage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rendered webpage </h2> <iframe src="../../samples/getting-started/store-objects/simple-counter-with-store.html" width="100%" height="250px"></iframe> <blockquote> <p><strong>What we have learned</strong></p> <ul> <li><strong>Usually, you want unidirectional data flow</strong> because it makes for robust and easily traceable code.</li> <li>However, <strong>if you have a complex app with a deep hierarchy of nested components</strong> and the requirement of <strong>shared state between components on different levels</strong> of the hierarchy, it is <strong>better to use a externalized shared object</strong>.</li> <li><strong>Hof.js supports all features of components in referenced externalized objects, too</strong>. This makes it extremely easy to share state because no new concepts have to be learned and no additional libraries are required.</li> </ul> </blockquote> <hr> <footer> Hof.js is an open source project of Hof University of Applied Sciences. It is MIT licensed. </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
